{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2018 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nexport default {\n  name: 'selectMenu',\n  add: function add(core) {\n    core.context.selectMenu = {\n      caller: {},\n      callerContext: null\n    };\n  },\n  setForm: function setForm() {\n    return '<div class=\"se-select-list\"></div>';\n  },\n  createList: function createList(listContext, items, html) {\n    listContext.form.innerHTML = '<ul>' + html + '</ul>';\n    listContext.items = items;\n    listContext.menus = listContext.form.querySelectorAll('li');\n  },\n  initEvent: function initEvent(pluginName, forms) {\n    var form = forms.querySelector('.se-select-list');\n    var context = this.context.selectMenu.caller[pluginName] = {\n      form: form,\n      items: [],\n      menus: [],\n      index: -1,\n      item: null,\n      clickMethod: null,\n      callerName: pluginName\n    };\n    form.addEventListener('mousedown', this.plugins.selectMenu.onMousedown_list);\n    form.addEventListener('mousemove', this.plugins.selectMenu.onMouseMove_list.bind(this, context));\n    form.addEventListener('click', this.plugins.selectMenu.onClick_list.bind(this, context));\n  },\n  onMousedown_list: function onMousedown_list(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  },\n  onMouseMove_list: function onMouseMove_list(context, e) {\n    this.util.addClass(context.form, '__se_select-menu-mouse-move');\n    var index = e.target.getAttribute('data-index');\n    if (!index) return;\n    context.index = index * 1;\n  },\n  onClick_list: function onClick_list(context, e) {\n    var index = e.target.getAttribute('data-index');\n    if (!index) return;\n    context.clickMethod.call(this, context.items[index]);\n  },\n  moveItem: function moveItem(listContext, num) {\n    this.util.removeClass(listContext.form, '__se_select-menu-mouse-move');\n    num = listContext.index + num;\n    var menus = listContext.menus;\n    var len = menus.length;\n    var selectIndex = listContext.index = num >= len ? 0 : num < 0 ? len - 1 : num;\n\n    for (var i = 0; i < len; i++) {\n      if (i === selectIndex) {\n        this.util.addClass(menus[i], 'active');\n      } else {\n        this.util.removeClass(menus[i], 'active');\n      }\n    }\n\n    listContext.item = listContext.items[selectIndex];\n  },\n  getItem: function getItem(listContext, index) {\n    index = !index || index < 0 ? listContext.index : index;\n    return listContext.items[index];\n  },\n  on: function on(callerName, clickMethod) {\n    var listContext = this.context.selectMenu.caller[callerName];\n    this.context.selectMenu.callerContext = listContext;\n    listContext.clickMethod = clickMethod;\n    listContext.callerName = callerName;\n  },\n  open: function open(listContext, positionHandler) {\n    var form = listContext.form;\n    form.style.visibility = 'hidden';\n    form.style.display = 'block';\n    positionHandler(form);\n    form.style.visibility = '';\n  },\n  close: function close(listContext) {\n    listContext.form.style.display = 'none';\n    listContext.items = [];\n    listContext.menus = [];\n    listContext.index = -1;\n    listContext.item = null;\n  },\n  init: function init(listContext) {\n    if (!listContext) return;\n    listContext.items = [];\n    listContext.menus = [];\n    listContext.index = -1;\n    listContext.item = null;\n    listContext.callerName = '';\n    this.context.selectMenu.callerContext = null;\n  }\n};","map":null,"metadata":{},"sourceType":"module"}